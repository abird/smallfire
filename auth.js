function e(){const e=localStorage.getItem("Firebase-Auth-Data");if(e){const t=JSON.parse(e);return t.tokenRefresh=s,t}}function t(e){const{tokenRefresh:t,...o}=e;localStorage.setItem("Firebase-Auth-Data",JSON.stringify(o))}async function o(e,t,o,n){const r=`https://identitytoolkit.googleapis.com/v1/${e}?key=${t}`,s=await fetch(r,{method:"POST",mode:"cors",cache:"no-cache",headers:{pragma:"no-cache","cache-control":"no-cache","Content-Type":n||"application/json"},body:"string"==typeof o?o:JSON.stringify(o)}),a=await s.json();if(!s.ok)throw a;return a}async function n(e,n,r){const a=await o("accounts:signInWithPassword",r,{email:e,password:n,returnSecureToken:!0});return a.apiKey=r,t(a),a.tokenRefresh=s,a}function r(){localStorage.removeItem("Firebase-Auth-Data")}async function s(){const e=await o("token",this.apiKey,`grant_type=refresh_token&refresh_token=${this.refreshToken}`,"application/x-www-form-urlencoded");this.idToken=e.id_token,this.refreshToken=e.refresh_token,t(this)}const a={currentUser:e,saveUser:t,signIn:n,signOut:r};"undefined"!=typeof window&&(window.smallfire=window.smallfire||{},window.smallfire.auth=a),"undefined"!=typeof module&&module.exports&&(module.exports=a);export{e as currentUser,t as saveUser,n as signIn,r as signOut};

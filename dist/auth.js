const e={currentUser:t,saveUser:n,signIn:a,signOut:r};function t(){const e=localStorage.getItem("Firebase-Auth-Data");if(e){const t=JSON.parse(e);return t.tokenRefresh=s,t}}function n(e){const{tokenRefresh:t,...n}=e;localStorage.setItem("Firebase-Auth-Data",JSON.stringify(n))}async function o(e,t,n,o){const a=`https://identitytoolkit.googleapis.com/v1/${e}?key=${t}`,r=await fetch(a,{method:"POST",mode:"cors",cache:"no-cache",headers:{pragma:"no-cache","cache-control":"no-cache","Content-Type":o||"application/json"},body:"string"==typeof n?n:JSON.stringify(n)}),s=await r.json();if(!r.ok)throw s;return s}async function a(e,t,a){const r=await o("accounts:signInWithPassword",a,{email:e,password:t,returnSecureToken:!0});return r.apiKey=a,n(r),r.tokenRefresh=s,r}function r(){localStorage.removeItem("Firebase-Auth-Data")}async function s(){const e=await o("token",this.apiKey,`grant_type=refresh_token&refresh_token=${this.refreshToken}`,"application/x-www-form-urlencoded");this.idToken=e.id_token,this.refreshToken=e.refresh_token,n(this)}"undefined"!=typeof window&&(window.smallfire=window.smallfire||{},window.smallfire.auth=e);export default e;export{t as currentUser,n as saveUser,a as signIn,r as signOut};
